# Fourier transform and spectroscopy

Every signal has a spectrum that can be analyzed in the time domain or the frequency domain. Alternatively, you can measure in the spatial domain or spatial frequency domain. The Fourier transform is a mathematical operation that converts a signal from the time domain to the frequency domain.

We use the Fourier transform to analyze the optical response of materials. Sometime when measuring the time-dependent nonlinear response of a material oscillatory signatures appear. The frequency of these oscillations corresponds to coherences and couplings within the system.

We also often use a spectrometer called a Fourier transform infrared (FTIR) spectrometer. This instrument measures the interference pattern of light from a sample (called the interferogram) and uses the Fourier transform to convert the interference pattern into a spectrum.

A proper Fourier transform course would take many weeks to cover. Here we will only cover the basics to understand how to compute the Fourier transform in Julia and interpret the results.

## Two frequencies

Imagine a bell that has been ringing since the beginning of time and will continue to ring forever, never to fade away. The bell has a frequency of 140 Hz or something.
The sound it produces is a perfect sine wave.
Since it is a a perfect sine wave its Fourier transform is a single sharp peak, a delta function, at 140 Hz.

More complicated signals composed of sine functions can be transformed to obtain their constituent frequencies.
A simple example, illustrated below, comprises a sine wave at 60 Hz and its first harmonic at 120 Hz at half the amplitude of the fundamental frequency.

![](/images/FFT_two_notes.png)

Let's implement this in code.
First we import the required packages,
GLMakie for visualization and FFTW for the Fourier transform (FFTW.jl is just a wrapper for the FFTW, the Fastest Fourier Transform in the West, library written in C).
Then we define the signal function.

```julia
using FFTW
using GLMakie

signal(t, f1, f2) = sin(2π * f1 * t) + 0.5 * sin(2π * f2 * t)
```

Next we define the sample rate and generate the time vector.
The sample rate is the number of times per second we sample the signal.
The sample rate is the inverse of the time step.
Half of the sample rate is called the Nyquist frequency, which is the highest frequency that can be accurately represented in the sampled signal.

```julia
fs = 1000 # sample rate in Hz
t_max = 1 # max time in seconds
t = 0:1/fs:t_max

f1 = 60 # frequency in Hz
f2 = 120 # frequency in Hz
y = signal.(t, f1, f2)
```

Now we can compute the Fourier transform of the signal with the following code.

```julia
Y = abs.(fftshift(fft(y)))
X = fftshift(fftfreq(length(t), fs))
```

Once you successfully plot the signal and its Fourier transform let's consider what the three functions &mdash; `fft`, `fftshift`, and `fftfreq` &mdash; in the code do.

The function `fft` computes the discrete Fourier transform (DFT) of the signal in a way that is computationally efficient.
The result is a complex array, which is why we take the absolute value of the result to get the amplitude spectrum.

The function `fftfreq` computes the frequencies corresponding to the Fourier transform based on the window size `n = length(t)` (the length of the time vector) and the sample spacing `fs`.
It returns the positive frequencies first, then the negative frequencies.
The Fourier transform is symmetric about 0 because it is defined on the interval (-∞, ∞).
Therefore, the second half of the Fourier transform is just a mirror image of the first half.
The function `fftshift` shifts the zero frequency component to the center of the spectrum to make it easier to visualize.
Examples for `fftfreq` can be found by typing `?fftfreq` in the Julia REPL or hovering over the function name in VS Code.
Likewise, `fft` also requires shifting to the center of the spectrum.

We can see what `fftshift` does by acting it on the numbers one through ten.

```julia
julia> fftshift(1:10)
10-element Vector{Int64}:
  6
  7
  8
  9
 10
  1
  2
  3
  4
  5
```