# Transfer Matrix Method

I find that one of the best ways to learn a physics concept is to implement it in code.
When I was in graduate school, that is exactly what I did when I built a transfer matrix simulation first in Python and then in Julia (which is the version we will be using).
Making you build an entire simulation from scratch is too much to ask, but at least we can use the transfer matrix method to simulate some simple structures with electromagnetic waves propagating through them.

The transfer matrix method simulates the propagation of electromagnetic waves through a series of layers.
It can produce a wide range of static phenomena, such as the reflection, transmission, and absorption of light, Bloch surface waves, and the electric fields existing inside the layers.
There are known limitations to the transfer matrix method, such as the fact that it cannot be used to simulate nonlinear effects or time-dependent phenomena, but it is a powerful tool in our lab for designing dielectric mirrors, simulating transmission spectra of complex structures, and analyzing polariton transmission spectra.
The transfer matrix implementation in TransferMatrix.jl is based on the work of Passler *et al.* (see references).
It is a general 4 x 4 matrix formalism that tries to avoid some of the traditional pitfalls of the traditional Yeh formalism (notably the tendency for singularities to occur in certain cases).
The code itself is modular and well-documented (I hope) so that it is easy to modify parts of the algorithm to suit your needs.


## Getting started

I have written both a quick start and longer tutorial on the [documentation website](https://garrek.org/TransferMatrix.jl/stable/) for TransferMatrix.jl.
First go through those examples and make sure you understand what the code is doing and also how to interpret the generated spectra.

Once you have done that, you will build your own structure and simulate a transmission spectrum.


## Problems

Find two materials on the [refractive index database](https://refractiveindex.info/) that have a large difference in refractive index in the mid-infrared region, somewhere between 2 and 10 μm.

1. What is the reflectivity of a dielectric mirror that has 3 periods of TiO2/SiO2 layers? How about for 10 periods? Use 10 periods for the rest of the questions.
2. What is the bandwidth of the stop band of a single DBR mirror?
3. What is the effective cavity length if the distance between the two mirror surfaces is 1 μm? Why is the effective cavity length different than when measured as the distance between the two mirror surfaces?
4. What is the cavity length required to have a resonance at 630 nm?
5. What is the cavity mode width Δc for the cavity in question 4? What lifetime does this correspond to? What is the Q-factor of the cavity?

#### Bonus problem
Use TransferMatrix.jl to simulate the reflectivity of the cavity and confirm your answers. Can you find the cavity mode at 630 nm? Can you find the cavity mode line width?
Calculate the electric field profile of the cavity mode (hint: Check the examples folder on the GitHub repository). Does it match what you would expect?

1. Build a dielectric mirror of two materials with different refractive indices.
   - Use the following parameters:
     - Material 1: $n_1 = 1.5$, thickness $d_1 = 100$ nm
     - Material 2: $n_2 = 2.0$, thickness $d_2 = 50$ nm
   - Simulate the transmission spectrum of the structure and plot it.
   - What is the wavelength of the first stop band?
   - What is the wavelength of the first transmission peak?
   - How does changing the thickness of each layer affect the transmission spectrum?


## References
- [Transfer Matrix Method](https://en.wikipedia.org/wiki/Transfer-matrix_method_(optics)) Wikipedia entry
- Yeh, P. *Optical Waves in Layered Media*; Wiley Series in Pure and Applied Optics; Wiley, 2005.

- Passler, N. C.; Paarmann, A. *Generalized 4 × 4 Matrix Formalism for Light Propagation in Anisotropic Stratified Media: Study of Surface Phonon Polaritons in Polar Dielectric Heterostructures*. J. Opt. Soc. Am. B 2017, 34 (10), 2128. https://doi.org/10.1364/JOSAB.34.002128.
- Passler, N. C.; Paarmann, A. *Generalized 4 × 4 Matrix Formalism for Light Propagation in Anisotropic Stratified Media: Study of Surface Phonon Polaritons in Polar Dielectric Heterostructures: Erratum*. J. Opt. Soc. Am. B 2019, 36 (11), 3246. https://doi.org/10.1364/JOSAB.36.003246.
- Garibello, B.; Avilán, N.; Galvis, J. A.; Herreño-Fierro, C. A. *On the Singularity of the Yeh 4 × 4 Transfer Matrix Formalism*. Journal of Modern Optics 2020, 67 (9), 832–836. https://doi.org/10.1080/09500340.2020.1775905.
